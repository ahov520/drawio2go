# M5: 国际化支持

## 目标

为缩略图组件添加无障碍访问和国际化支持。

## 修改文件

### 1. 中文翻译

`/public/locales/zh-CN/chat.json`

```json
{
  "aria": {
    "conversationPreview": "对话 {{title}} 的预览图",
    "noPreviewPlaceholder": "暂无预览图"
  }
}
```

### 2. 英文翻译

`/public/locales/en-US/chat.json`

```json
{
  "aria": {
    "conversationPreview": "Preview of conversation {{title}}",
    "noPreviewPlaceholder": "No preview available"
  }
}
```

## 组件集成

在 `ConversationThumbnail.tsx` 中添加 aria-label：

```tsx
import { useAppTranslation } from "@/app/i18n/hooks"

export function ConversationThumbnail({
  svgDataUrl,
  loading,
  alt
}: ConversationThumbnailProps) {
  const { t } = useAppTranslation("chat")

  if (loading) {
    return <Skeleton ... />
  }

  if (!svgDataUrl) {
    return (
      <div
        className="conversation-thumbnail-placeholder"
        role="img"
        aria-label={t("aria.noPreviewPlaceholder")}
      >
        <FileQuestion size={20} />
      </div>
    )
  }

  return (
    <img
      src={svgDataUrl}
      alt={alt || t("aria.conversationPreview", { title: "未命名对话" })}
      className="conversation-thumbnail"
      loading="lazy"
    />
  )
}
```

## 无障碍设计

### 1. 语义化标签

- **有预览**：使用 `<img>` 标签，屏幕阅读器读取 `alt` 文本
- **无预览**：使用 `role="img"` + `aria-label`，确保被识别为图像元素

### 2. Alt 文本策略

- **优先级 1**：使用父组件传入的 `alt`（通常是对话标题）
- **优先级 2**：使用翻译键 `aria.conversationPreview`
- **回退**：使用通用描述

### 3. 占位符标记

```tsx
<div
  className="conversation-thumbnail-placeholder"
  role="img"
  aria-label={t("aria.noPreviewPlaceholder")}
>
```

- `role="img"` 声明为图像区域
- `aria-label` 提供描述文本

## 翻译参数化

在 `ConversationList` 中传入标题：

```tsx
<ConversationThumbnail
  svgDataUrl={preview?.svgDataUrl ?? null}
  loading={!preview}
  alt={t("aria.conversationPreview", { title })}
/>
```

## 验收标准

- [ ] 中英文翻译完整
- [ ] 屏幕阅读器能正确读取预览图描述
- [ ] 语言切换后文本正确更新
- [ ] 占位符有正确的 ARIA 标记
- [ ] Alt 文本包含对话标题
